{"version":3,"file":"svg-plant.cjs.js","sources":["../node_modules/@babel/runtime/helpers/defineProperty.js","../src/util/util.ts","../src/Plant/plantPotSvg.ts","../src/util/bezierCurveBoundingBox.ts","../src/Plant/PlantBody.ts","../src/Plant/SvgPlant.ts","../src/Genera/BaseGenus.ts","../src/Genera/CannabisGenus.ts","../src/util/DevTools.ts","../src/main.ts"],"sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","import seedrandom from 'seedrandom';\nimport { attributeSet, pathDescriptionSegment, point, rngSeed } from '../types';\n\nconst html = {\n    node( tag: string, set?: attributeSet ): Element {\n        const node = document.createElement( tag );\n        html.attr( node, set );\n        return node;\n    },\n    nodeNS( tag: string, set: attributeSet, ns: string ): Element {\n        const node = document.createElementNS( ns, tag );\n        html.attr( node, set );\n        return node;\n    },\n    attr( node: Element, set: attributeSet = {} ): void {\n        for (let name in set) node.setAttribute( name, String( set[ name ] ) );\n    },\n\n    svg: {\n        root( set?: attributeSet ): SVGElement {\n            const svg = <SVGElement>html.svg.node( 'svg', set );\n            svg.setAttribute( 'xmlns', \"http://www.w3.org/2000/svg\" );\n            svg.setAttributeNS( \"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\" );\n            return svg;\n        },\n        node( tag: string, set?: attributeSet ): SVGElement {\n            const el = <SVGElement>html.nodeNS( tag, {}, \"http://www.w3.org/2000/svg\" );\n            html.attr( el, set );\n            return el;\n        },\n\n        compilePathDescription( points: pathDescriptionSegment[] ): string {\n            const d = [];\n\n            for (const p of points) {\n                if (p.length == 1) d.push( p );\n                else if (p.length == 2) d.push( p[0], p[1] );\n                else if (p.length == 3) d.push( p[0], p[1], p[2] );\n            }\n\n            return d.join( ' ' );\n        }\n    },\n};\n\nconst math = {\n    toRadians( degrees: number ): number {\n        return degrees * (Math.PI / 180);\n    },\n\n    fromAngle( point: point, angle: number, length: number, precision?:number ): point {\n        const a: point = [\n            Math.sin( math.toRadians( angle ) ) * length + point[0],\n            - Math.cos( math.toRadians( angle ) ) * length + point[1],\n        ];\n\n        if (precision) {\n            a[ 0 ] = Math.round( a[ 0 ] * precision );\n            a[ 1 ] = Math.round( a[ 1 ] * precision );\n        }\n\n        return a;\n    },\n\n    rectFromLine(\n        pointBottom: point, pointTop: point,\n        angleBottom: number, angleTop: number,\n        widthBottom: number, widthTop: number,\n        precision?: number\n    ): [ point, point, point, point ] {\n        widthBottom /= 2;\n        widthTop /= 2;\n        return [\n            math.fromAngle( pointBottom, angleBottom - 90, widthBottom, precision ),\n            math.fromAngle( pointTop, angleTop - 90, widthTop, precision ),\n            math.fromAngle( pointTop, angleTop + 90, widthTop, precision ),\n            math.fromAngle( pointBottom, angleBottom + 90, widthBottom, precision )\n        ];\n    },\n\n    pointOnLine( p1: point, p2: point, d: number ): point {\n        return [\n            p1[0] + d * (p2[0] - p1[0]),\n            p1[1] + d * (p2[1] - p1[1]),\n        ];\n    },\n\n    distance( p1: point, p2: point ): number {\n        const dx = p1[0] - p2[0];\n        const dy = p1[1] - p2[1];\n        return Math.sqrt( dx*dx + dy*dy );\n    }\n};\n\nconst plantHelper = {\n    rootPosAngle( rng: rng, xMax: number, maxAngle: number ) {\n        const x = rng.range( -xMax, xMax );\n        const f = Math.abs( x ) / xMax;\n        return {\n            x,\n            segmentAngle: maxAngle * f * (x < 0 ? -1 : 1),\n        };\n    },\n\n    segmentAngle( baseNode: node ): number {\n        if (baseNode.attr.segmentAngle !== undefined) return baseNode.attr.segmentAngle;\n        return baseNode.attr.angle;\n    },\n\n    nextAngle( rng: rng, pos: nodePos, prevNode: node, variance: number, alternate: boolean ): number {\n        if (pos.isOffshoot) return prevNode.attr.angle;\n\n        const pa = this.segmentAngle( prevNode );\n\n        if (alternate) {\n            const dir = pos.branchNum>0 ? 1 : prevNode.treeRoot.attr.x>=0 ? 1 : -1;\n            return pa + (prevNode.pos.num % 2 ? 1 : -1) * rng.range( 0, variance ) * dir;\n        }\n        else {\n            return pa + rng.range( -variance, variance );\n        }\n    },\n\n    archingBranchAngle( rng: rng, pos: nodePos, prevNode: node, variance: number, numAdjust: number ): number {\n        if (pos.isOffshoot) return prevNode.attr.angle;\n\n        const pa = plantHelper.segmentAngle( prevNode );\n        const base = prevNode.branchRoot.attr.branchArchAngle;\n        const f = numAdjust ? (1 - numAdjust) + numAdjust * (1 - pos.numFactor) : 1;\n\n        return pa + f * base + rng.range( -variance, variance );\n    },\n\n    repeat<T,U=number>(\n        { rng, cb, p=1, shuffle=true, steps, values, n }:\n        {\n            rng: rng,\n            cb: ( i: number | U ) => T,\n            steps?: { from: number, to: number, step: number },\n            values?: U[],\n            n?: number | [ number, number ],\n            p?: number, shuffle?: boolean\n        }\n    ): T[] {\n        const a: T[] = [];\n\n        if (p <= 0) return a;\n        const test = p < 1;\n\n        if (values !== undefined) {\n            for (let v of values) if (!test || rng.test( p )) {\n                a.push( cb( v ) );\n            }\n        }\n        else if (steps !== undefined) {\n            for (let i=steps.from; i<=steps.to; i+=steps.step) if (!test || rng.test( p )) {\n                a.push( cb( i ) );\n            }\n        }\n        else if (n !== undefined) {\n            if (Array.isArray( n )) n = rng.intRange( n[0], n[1] );\n\n            for (let i=0; i<n; i++) if (!test || rng.test( p )) {\n                a.push( cb( i ) );\n            }\n        }\n\n        if (shuffle) rng.shuffle( a );\n\n        return a;\n    }\n};\n\ninterface rng {\n    seed: string;\n    reset(): void;\n    random( v: number ): number;\n    test( p: number ): boolean;\n    test<T,U>( p: number, pass: T, fail: U ): T | U;\n    test<T,U>( p: number, pass?: T, fail?: U ): T | U | boolean;\n    range( v0: number, v1: number ): number;\n    intRange( v0: number, v1: number ): number;\n    ranges( ... ranges: Array<[ number, number, number? ]> ): number;\n    shuffle( a: Array<any> ): Array<any>;\n};\nconst rng = (seed: rngSeed): rng => {\n    const seedStr = (seed === undefined) ? (Math.random() + '').substring( 2 ) : String( seed );\n    let fn: seedrandom.prng;\n\n    const rng = {\n        get seed(): string {\n            return seedStr;\n        },\n        reset(): void {\n            fn = seedrandom( seedStr );\n        },\n\n        random( v=1 ): number {\n            return fn() * v;\n        },\n        test<T,U>( p=.5, pass?: T, fail?: U ): T | U | boolean {\n            const r = p >= 1 ? true : p <= 0 ? false : fn() < p;\n            if (r) return pass === undefined ? true : pass;\n            return fail === undefined ? false : fail;\n        },\n        range( v0: number, v1: number ): number {\n            if (v0==v1) return v0;\n            return v0 + fn() * ( v1 - v0 );\n        },\n        intRange( v0: number, v1: number ): number {\n            if (v0==v1) return v0;\n            return v0 + Math.floor( fn() * ( v1 - v0 + 1 ) );\n        },\n        ranges( ... ranges: Array<[ number, number, number? ]> ): number {\n            if (!ranges.length) return 0;\n\n            const ep = 1 / ranges.length;\n\n            ranges = [ ... ranges ];\n            const last = ranges.pop();\n\n            for (let r of ranges) {\n                const p = r[2] || ep;\n                if (rng.test( p )) return rng.range( r[0], r[1] );\n            }\n\n            return last ? rng.range( last[0], last[1] ) : 0;\n        },\n\n        shuffle( a: Array<any> ): Array<any> {\n            for (let i = a.length - 1; i > 0; i--) {\n                const j = Math.floor( fn() * (i + 1) );\n                const tmp = a[i];\n                a[i] = a[j];\n                a[j] = tmp;\n            }\n            return a;\n        }\n    };\n\n    rng.reset();\n\n    return rng;\n}\n\ninterface bboxData {\n    x0: number;\n    x1: number;\n    y0: number;\n    y1: number;\n    [propName: string]: any;\n};\nclass BBox {\n    x0: number;\n    x1: number;\n    y0: number;\n    y1: number;\n\n    constructor(data?: bboxData) {\n        if (data) {\n            this.x0 = data.x0;\n            this.x1 = data.x1;\n            this.y0 = data.y0;\n            this.y1 = data.y1;\n        }\n        else {\n            this.x0 = Infinity;\n            this.x1 = -Infinity;\n            this.y0 = Infinity;\n            this.y1 = -Infinity;\n        }\n    }\n\n    addX( v: number ): this {\n        if (v < this.x0) this.x0 = v;\n        if (v > this.x1) this.x1 = v;\n        return this;\n    }\n    addY( v: number ): this {\n        if (v < this.y0) this.y0 = v;\n        if (v > this.y1) this.y1 = v;\n        return this;\n    }\n    addPoint( x: number, y: number ): this {\n        this.addX( x );\n        this.addY( y );\n        return this;\n    }\n    addBBox( bbox: bboxData ): this {\n        this.addX( bbox.x0 );\n        this.addX( bbox.x1 );\n        this.addY( bbox.y0 );\n        this.addY( bbox.y1 );\n        return this;\n    }\n\n    expand( v: number ): this {\n        this.x0 -= v;\n        this.x1 += v;\n\n        this.y0 -= v;\n        this.y1 += v;\n\n        return this;\n    }\n\n    contains( bbox: bboxData, strict: boolean ): boolean {\n        if (strict) return this.x0 < bbox.x0 && this.x1 > bbox.x1 && this.y0 < bbox.y0 && this.y1 > bbox.y1;\n        return this.x0 <= bbox.x0 && this.x1 >= bbox.x1 && this.y0 <= bbox.y0 && this.y1 >= bbox.y1;\n    }\n    containedBy( bbox: bboxData, strict: boolean ): boolean {\n        if (strict) return this.x0 > bbox.x0 && this.x1 < bbox.x1 && this.y0 > bbox.y0 && this.y1 < bbox.y1;\n        return this.x0 >= bbox.x0 && this.x1 <= bbox.x1 && this.y0 >= bbox.y0 && this.y1 <= bbox.y1;\n    }\n    containsPoint( x: number, y: number, strict: boolean ): boolean {\n        if (strict) return !( x <= this.x0 || x >= this.x1 || y <= this.y0 || y >= this.y1 );\n        return !( x < this.x0 || x > this.x1 || y < this.y0 || y > this.y1 );\n    }\n\n    clone(): BBox {\n        return new BBox( this.data );\n    }\n\n    withPrecision( p: number ): BBox {\n        return new BBox({\n            x0: Math.round( this.x0 * p ),\n            x1: Math.round( this.x1 * p ),\n            y0: Math.round( this.y0 * p ),\n            y1: Math.round( this.y1 * p ),\n        });\n    }\n\n    get width(): number {\n        return this.x1 - this.x0;\n    }\n    get height(): number {\n        return this.y1 - this.y0;\n    }\n\n    get aspectRatio(): number {\n        if (!this.height) return 0;\n        return this.width / this.height;\n    }\n\n    get data(): bboxData {\n        return {\n            x0: this.x0,\n            x1: this.x1,\n            y0: this.y0,\n            y1: this.y1\n        };\n    }\n\n    get pointsArray(): [ point, point ] {\n        return [\n            [ this.x0, this.y0 ],\n            [ this.x1, this.y1 ],\n        ];\n    }\n\n    get viewBox(): string {\n        return `${this.x0} ${this.y0} ${this.width} ${this.height}`;\n    }\n}\n\ninterface nodePos {\n    num: number,\n    branchNum: number,\n\n    height: number,\n    offshootHeight: number,\n\n    isRoot: boolean,\n\n    isLast: boolean,\n    isLastBranch: boolean,\n\n    isOffshoot: boolean,\n\n    numFactor: number,\n    branchFactor: number,\n};\ninterface nodeAttr {\n    [key: string]: any,\n};\ninterface offshoot {\n    n: number,\n    attr?: nodeAttr,\n};\ninterface node {\n    pos: nodePos,\n    attr: nodeAttr,\n    offshoots: node[],\n\n    prev: node | null,\n    next: node | null,\n\n    branchRoot: node,\n    treeRoot: node,\n\n    offshootNum: number,\n};\ntype getNode = (pos: nodePos, prev: node | null, rootAttr: nodeAttr) => nodeAttr;\ntype getOffshoots = (node: node | null) => offshoot[];\nclass ProcTree {\n\n    maxBranchNum: number;\n    getNode: getNode;\n    getOffshoots: getOffshoots;\n\n    private roots: node[];\n\n    constructor( maxBranchNum: number, getNode: getNode, getOffshoots: getOffshoots ) {\n        this.maxBranchNum = maxBranchNum;\n        this.getNode = getNode;\n        this.getOffshoots = getOffshoots;\n\n        this.roots = [];\n    }\n\n    grow(): void {\n        const roots = this.getOffshoots( null );\n        for (let i in roots) this.growBranch( null, Number( i ), roots[ i ].n, roots[ i ].attr || {} );\n    }\n\n    growBranch( rootNode: node | null, offshootNum: number, segmentCount: number, attr: nodeAttr ): void {\n        const isTreeRoot = !rootNode;\n\n        let node = this.addNode( rootNode, true, offshootNum, segmentCount, attr );\n\n        if (isTreeRoot) this.roots.push( node );\n        const isLastBranch = this.maxBranchNum == node.pos.branchNum;\n\n        if (!isLastBranch && isTreeRoot) {\n            const offshoots = this.getOffshoots( node );\n            for (let i in offshoots) this.growBranch( node, Number( i ), offshoots[ i ].n, offshoots[ i ].attr || {} );\n        }\n\n        for (let i=0; i<segmentCount; i++) {\n            node = this.addNode( node, false, offshootNum, segmentCount, {} );\n            if (!isLastBranch) {\n                const offshoots = this.getOffshoots( node );\n                for (let i in offshoots) this.growBranch( node, Number( i ), offshoots[ i ].n, offshoots[ i ].attr || {} );\n            }\n        }\n    }\n\n    addNode( prev: node | null, isOffshoot: boolean, offshootNum: number, maxNum: number, rootAttr: nodeAttr ): node {\n        const pos = this.getPos( prev ? prev.pos : null, isOffshoot, maxNum );\n        const node: node = {\n            pos,\n            attr: { ... rootAttr, ... this.getNode( pos, prev, rootAttr ) },\n            offshoots: [],\n\n            prev: null,\n            next: null,\n\n            branchRoot: <node>{},\n            treeRoot: <node>{},\n\n            offshootNum: 0,\n        };\n\n        if (prev) {\n            node.prev = prev;\n            node.branchRoot = isOffshoot ? node : prev.pos.isOffshoot ? prev : prev.branchRoot;\n            node.treeRoot = prev.treeRoot ? prev.treeRoot : prev;\n\n            if (isOffshoot) {\n                prev.offshoots.push( node );\n                node.offshootNum = offshootNum;\n            }\n            else {\n                prev.next = node;\n            }\n\n        }\n        else {\n            node.branchRoot = node;\n            node.treeRoot = node;\n            node.offshootNum = offshootNum;\n        }\n\n        return node;\n    }\n\n    getPos( prev: nodePos | null, isOffshoot: boolean, maxNum: number ): nodePos {\n        if (prev === null) return {\n            num: 0,\n            branchNum: 0,\n\n            height: 0,\n            offshootHeight: 0,\n\n            isRoot: true,\n\n            isLast: maxNum == 0,\n            isLastBranch: this.maxBranchNum == 0,\n\n            isOffshoot,\n\n            numFactor: 1,\n            branchFactor: 1,\n        };\n\n        const pos: nodePos = {\n            num: isOffshoot ? 0 : prev.num + 1,\n            branchNum: isOffshoot ? prev.branchNum + 1 : prev.branchNum,\n\n            height: isOffshoot ? prev.height : prev.height + 1,\n            offshootHeight: isOffshoot ? prev.num : prev.offshootHeight,\n\n            isRoot: false,\n\n            isLast: false,\n            isLastBranch: false,\n\n            isOffshoot,\n\n            numFactor: 0,\n            branchFactor: 0,\n        };\n\n        if (pos.num == maxNum) pos.isLast = true;\n        if (pos.branchNum == this.maxBranchNum) pos.isLastBranch = true;\n\n        pos.numFactor = maxNum ? (1 - pos.num / maxNum) : 1;\n        pos.branchFactor = this.maxBranchNum ? (1 - pos.branchNum / this.maxBranchNum) : 1;\n\n        return pos;\n    }\n\n    eachSegment( cb: (n0: node, n1: node) => void ): void {\n        for (let node of this.roots) this._each( node, cb );\n    }\n    _each( node: node | null, cb: (n0: node, n1: node) => void ): void {\n        // note: the treeRoot node can have offshoots\n        // other nodes that are branchRoots cannot have offshoots\n        while ( node ) {\n            if (node.pos.num > 0 && node.prev) cb( node.prev, node );\n            for (let offshootNode of node.offshoots) this._each( offshootNode.next, cb );\n            node = node.next;\n        }\n    }\n}\n\nexport {\n    html,\n    math,\n    plantHelper,\n    rng, rng as rngInterface,\n    BBox,\n    ProcTree, nodePos, nodeAttr, offshoot, node\n};","import { html } from \"../util/util\";\nimport { attributeSet, pathDescriptionSegment } from '../types';\n\ninterface PlantPotCfg {\n    rimHeight: number,\n    rimLipOuter: number,\n    rimLipInner: number,\n    bottom: number,\n};\n\nfunction plantPotSvg( pathAttr: attributeSet ): SVGElement {\n    const baseCfg: PlantPotCfg = {\n        rimHeight: 40,\n        rimLipOuter: 2,\n        rimLipInner: 7,\n        bottom: 10\n    };\n\n    const sw = pathAttr ? ('stroke-width' in pathAttr ? pathAttr[ 'stroke-width' ] : 2) : false;\n    if (sw) pathAttr[ 'stroke-width' ] = sw;\n\n    const pad = sw && typeof sw == 'number' ? sw / 2 : 0;\n\n    const getPoints = (cfg: PlantPotCfg): pathDescriptionSegment[] => {\n        return [\n            [ 'M', pad, pad ],\n            [ 'L', 100-pad, pad ],\n            [ 'L', 100-pad - cfg.rimLipOuter, cfg.rimHeight ],\n            [ 'L', 100-pad - cfg.rimLipInner, cfg.rimHeight ],\n            [ 'L', 100-pad - cfg.bottom, 100-pad ],\n            [ 'L', pad+cfg.bottom, 100-pad ],\n            [ 'L', pad+cfg.rimLipInner, cfg.rimHeight ],\n            [ 'L', pad+cfg.rimLipOuter, cfg.rimHeight ],\n            'Z',\n        ];\n    };\n\n    if (!pathAttr) pathAttr = {};\n    pathAttr.d = html.svg.compilePathDescription( getPoints( baseCfg ) );\n    const path = html.svg.node( 'path', pathAttr );\n\n    const svg = html.svg.root({\n        class: 'svg-plant-pot',\n        viewBox: '0 0 100 100',\n        preserveAspectRatio: 'xMidYMax meet',\n    });\n\n    svg.appendChild( path );\n\n    return svg;\n};\n\nexport { plantPotSvg };","// ripped from https://github.com/kfitfk/svg-boundings\n\ninterface bounds {\n  minX: number;\n  maxX: number;\n  minY: number;\n  maxY: number;\n};\n\n/**\n * expand the x-bounds, if the value lies outside the bounding box\n */\nfunction expandXBounds(bounds: bounds, value: number) {\n  if (bounds.minX > value) bounds.minX = value;\n  else if (bounds.maxX < value) bounds.maxX = value;\n}\n\n/**\n * expand the y-bounds, if the value lies outside the bounding box\n */\nfunction expandYBounds(bounds: bounds, value: number) {\n  if (bounds.minY > value) bounds.minY = value;\n  else if (bounds.maxY < value) bounds.maxY = value;\n}\n\n/**\n * Calculate the bezier value for one dimension at distance 't'\n */\nfunction calculateBezier(t: number, p0: number, p1: number, p2: number, p3: number) {\n  var mt = 1-t;\n  return (mt*mt*mt*p0) + (3*mt*mt*t*p1) + (3*mt*t*t*p2) + (t*t*t*p3);\n}\n\n/**\n * Calculate the bounding box for this bezier curve.\n * http://pomax.nihongoresources.com/pages/bezier/\n */\nfunction bezierCurveBoundingBox(\n  x1: number, y1: number,\n  cx1: number, cy1: number, cx2: number, cy2: number,\n  x2: number, y2: number\n) {\n  var bounds = {\n    minX: Math.min(x1, x2),\n    minY: Math.min(y1, y2),\n    maxX: Math.max(x1, x2),\n    maxY: Math.max(y1, y2),\n  };\n\n  var dcx0 = cx1 - x1;\n  var dcy0 = cy1 - y1;\n  var dcx1 = cx2 - cx1;\n  var dcy1 = cy2 - cy1;\n  var dcx2 = x2 - cx2;\n  var dcy2 = y2 - cy2;\n\n  if (cx1<bounds.minX || cx1>bounds.maxX || cx2<bounds.minX || cx2>bounds.maxX) {\n    // Just for better reading because we are doing middle school math here\n    var a = dcx0;\n    var b = dcx1;\n    var c = dcx2;\n\n    if (a+c !== 2*b) b += 0.0001;\n\n    var numerator = 2*(a - b);\n    var denominator = 2*(a - 2*b + c);\n    if (denominator === 0) denominator = 0.0001;\n    var quadroot = (2*b-2*a)*(2*b-2*a) - 2*a*denominator;\n    var root = Math.sqrt(quadroot);\n\n    var t1 =  (numerator + root) / denominator;\n    var t2 =  (numerator - root) / denominator;\n\n    if (0<t1 && t1<1) {\n      expandXBounds(bounds, calculateBezier(t1, x1, cx1, cx2, x2));\n    }\n    if (0<t2 && t2<1) {\n      expandXBounds(bounds, calculateBezier(t2, x1, cx1, cx2, x2));\n    }\n  }\n\n  if (cy1<bounds.minY || cy1>bounds.maxY || cy2<bounds.minY || cy2>bounds.maxY) {\n    a = dcy0;\n    b = dcy1;\n    c = dcy2;\n\n    if (a+c !== 2*b) b += 0.0001;\n\n    numerator = 2*(a - b);\n    denominator = 2*(a - 2*b + c);\n    if (denominator === 0) denominator = 0.0001;\n    quadroot = (2*b-2*a)*(2*b-2*a) - 2*a*denominator;\n    root = Math.sqrt(quadroot);\n\n    t1 =  (numerator + root) / denominator;\n    t2 =  (numerator - root) / denominator;\n\n    if (0<t1 && t1<1) {\n      expandYBounds(bounds, calculateBezier(t1, y1, cy1, cy2, y2));\n    }\n    if (0<t2 && t2<1) {\n      expandYBounds(bounds, calculateBezier(t2, y1, cy1, cy2, y2));\n    }\n  }\n\n  return {\n    x0: bounds.minX,\n    x1: bounds.maxX,\n    y0: bounds.minY,\n    y1: bounds.maxY,\n  };\n}\n\nexport { bezierCurveBoundingBox };","import { ProcTree, html, math, BBox, node, nodePos, nodeAttr, offshoot } from \"../util/util\";\nimport { bezierCurveBoundingBox } from \"../util/bezierCurveBoundingBox\";\nimport { point, attributeSet, leafCurvesHandles, leafDefinition, pathDescriptionSegment, Genus } from '../types';\n\nconst precision = 10000;\nfunction prc(v: number): number;\nfunction prc(v: point): point;\nfunction prc(v: number | point): number | point {\n    if (Array.isArray( v )) return [\n        Math.round( v[0] * precision ),\n        Math.round( v[1] * precision ),\n    ];\n\n    return Math.round( v * precision );\n}\n\ninterface PlantPart {\n    base: point;\n    top: point;\n\n    angle: number;\n    length: number;\n\n    ageOffset: number;\n    style: attributeSet;\n\n    bbox: BBox;\n\n    getPoints( age: number ): pathDescriptionSegment[] | undefined;\n};\nclass BranchSegment implements PlantPart {\n    base: point;\n    top: point;\n\n    bottomWidth: number;\n    topWidth: number;\n\n    angle: number;\n    bottomAngle: number;\n    topAngle: number;\n\n    length: number;\n\n    ageOffset: number;\n    style: attributeSet;\n\n    bbox: BBox;\n\n    constructor( base: point, style: attributeSet, n0: node, n1: node ) {\n        this.base = base;\n\n        this.bottomWidth = n0.attr.width;\n        this.topWidth = n1.attr.width;\n\n        this.angle = n0.attr.segmentAngle !== undefined ? n0.attr.segmentAngle : n0.attr.angle;\n        this.bottomAngle = n0.attr.angle;\n        this.topAngle = n1.attr.angle;\n\n        this.length = n0.attr.length;\n\n        this.top = math.fromAngle( this.base, this.angle, this.length );\n\n        this.ageOffset = n0.attr.totalLength;\n        this.style = style;\n\n        this.bbox = this.getBoundingBox();\n    }\n\n    getPoints( age: number ): pathDescriptionSegment[] | undefined {\n        const ageFactor = this.getAgeFactor( age );\n        if (!ageFactor) return;\n\n        let top = this.top;\n        if (ageFactor < 1) {\n            top = math.fromAngle( this.base, this.angle, this.length * ageFactor );\n        }\n\n        const r = math.rectFromLine(\n            this.base, top,\n            this.bottomAngle, this.topAngle,\n            this.bottomWidth, this.topWidth,\n            precision,\n        );\n\n        return [\n            'M', r[0],\n            'L', r[1],\n            'L', r[2],\n            'L', r[3],\n            'Z'\n        ];\n    }\n\n    private getBoundingBox(): BBox {\n        const points = math.rectFromLine(\n            this.base, this.top,\n            this.bottomAngle, this.topAngle,\n            this.bottomWidth, this.topWidth,\n            undefined\n        );\n\n        const bb = new BBox();\n        bb.addPoint( points[0][0], points[0][1] );\n        bb.addPoint( points[1][0], points[1][1] );\n        bb.addPoint( points[2][0], points[2][1] );\n        bb.addPoint( points[3][0], points[3][1] );\n\n        return bb;\n    }\n\n    private getAgeFactor( age: number ): number {\n        if (age <= this.ageOffset) return 0;\n        if (age >= this.ageOffset + this.length) return 1;\n        return (age - this.ageOffset) / this.length;\n    }\n\n    getOffsetPoint( x: number, y: number ): point {\n        if (!x) {\n            if (!y) return this.base;\n            if (y==1) return this.top;\n            return math.fromAngle( this.base, this.angle, this.length * y );\n        }\n\n        const dir = this.angle < 0 ? 1 : -1;\n\n        if (!y) {\n            return math.fromAngle( this.base, this.bottomAngle + 90*dir, this.bottomWidth/2 * x );\n        }\n\n        if (y==1) {\n            return math.fromAngle( this.top, this.topAngle + 90*dir, this.topWidth/2 * x );\n        }\n\n        const l1 = [\n            math.fromAngle( this.base, this.bottomAngle + 90*dir, this.bottomWidth/2 ),\n            math.fromAngle( this.top, this.topAngle + 90*dir, this.topWidth/2 )\n        ];\n        const l2 = [\n            math.fromAngle( this.base, this.bottomAngle + 90*dir, -this.bottomWidth/2 ),\n            math.fromAngle( this.top, this.topAngle + 90*dir, -this.topWidth/2 )\n        ];\n        const l3 = [\n            math.pointOnLine( l1[0], l1[1], y ),\n            math.pointOnLine( l2[0], l2[1], y ),\n        ];\n\n        x = 1 - (x/2 + .5);\n\n        return math.pointOnLine( l3[0], l3[1], x );\n    }\n}\nclass Leaf implements PlantPart {\n    base: point;\n    pBase: point;\n    top: point;\n\n    angle: number;\n    length: number;\n    handles: leafCurvesHandles;\n\n    ageOffset: number;\n    style: attributeSet;\n\n    bbox: BBox;\n\n    constructor( segment: BranchSegment, { angle, length, handles, style, xOffset, yOffset }: leafDefinition ) {\n        const base = segment.getOffsetPoint( xOffset, yOffset );\n        this.base = base;\n        this.pBase = prc( base );\n\n        this.angle = angle;\n        this.length = length;\n        this.handles = handles;\n\n        this.top = math.fromAngle( base, angle, length );\n\n        this.ageOffset = segment.ageOffset + segment.length * yOffset;\n\n        this.style = style;\n\n        this.bbox = this.getBoundingBox();\n    }\n\n    getPoints( age: number ): pathDescriptionSegment[] | undefined {\n        const ageFactor = this.getAgeFactor( age );\n        if (!ageFactor) return;\n\n        let top = this.top;\n        if (ageFactor < 1) {\n            top = math.fromAngle( this.base, this.angle, this.length * ageFactor );\n        }\n\n        const curves = this.getCurves({ top, ageFactor, precision });\n\n        top = prc( top );\n\n        return [\n            'M', this.pBase,\n            'C', curves.up[0], curves.up[1], top,\n            'C', curves.down[0], curves.down[1], this.pBase\n        ];\n    }\n\n    private getBoundingBox(): BBox {\n        const c = this.getCurves({ top: this.top, ageFactor: 1 });\n        const bb = new BBox(bezierCurveBoundingBox(\n            this.base[0], this.base[1],\n            c.up[0][0], c.up[0][1],\n            c.up[1][0], c.up[1][1],\n            this.top[0], this.top[1],\n        ));\n\n        bb.addBBox(bezierCurveBoundingBox(\n            this.top[0], this.top[1],\n            c.down[0][0], c.down[0][1],\n            c.down[1][0], c.down[1][1],\n            this.base[0], this.base[1],\n        ));\n\n        if (typeof this.style['stroke-width'] == 'number') bb.expand( this.style['stroke-width'] / 2 );\n\n        return bb;\n    }\n\n    private getCurves(\n        { top, ageFactor, precision }: { top: point; ageFactor: number; precision?: number; }\n    ): { up: [ point, point ], down: [ point, point ] } {\n        const bha = this.handles.bottomAngle;\n        const bhl = this.handles.bottomLength * ageFactor;\n        const tha = this.handles.topAngle;\n        const thl = this.handles.topLength * ageFactor;\n\n        return {\n            up: [\n                math.fromAngle( this.base, this.angle + bha, this.length * bhl, precision ),\n                math.fromAngle( top, this.angle + tha, this.length * thl, precision ),\n            ],\n            down: [\n                math.fromAngle( top, this.angle - tha, this.length * thl, precision ),\n                math.fromAngle( this.base, this.angle - bha, this.length * bhl, precision ),\n            ],\n        };\n    }\n\n    private getAgeFactor( age: number ): number {\n        if (age <= this.ageOffset) return 0;\n        if (age >= this.ageOffset + this.length) return 1;\n        return (age - this.ageOffset) / this.length;\n    }\n}\n\nclass Branches {\n    segments: BranchSegment[][];\n    leaves: Leaf[][];\n\n    constructor() {\n        this.segments = [];\n        this.leaves = [];\n    }\n\n    addSegment( branchNum: number, segment: BranchSegment ) {\n        let branch = this.segments[ branchNum ];\n        if (!branch) {\n            branch = [];\n            this.segments[ branchNum ] = branch;\n        }\n        branch.push( segment );\n    }\n    addLeaf( branchNum: number, leaf: Leaf ) {\n        let branch = this.leaves[ branchNum ];\n        if (!branch) {\n            branch = [];\n            this.leaves[ branchNum ] = branch;\n        }\n        branch.push( leaf );\n    }\n\n    getArray(): PlantPart[] {\n        let ret: PlantPart[] = [];\n        for (let i=0; i<this.segments.length; i++) {\n            ret = ret.concat( this.segments[ i ] || [] );\n            ret = ret.concat( this.sortLeaves( this.leaves[ i ] ) );\n        }\n\n        return ret;\n    }\n\n    sortLeaves( a: Leaf[] ): Leaf[] {\n        if (!a) return [];\n\n        return a.sort((l0,l1) => {\n            if (l1.bbox.containsPoint( l0.base[0], l0.base[1], true )) {\n                return -1;\n            }\n\n            if (l0.bbox.containsPoint( l1.base[0], l1.base[1], true )) {\n                return 1;\n            }\n\n            const d0 = math.distance( l0.base, [0,0] );\n            const d1 = math.distance( l1.base, [0,0] );\n            return d1 - d0;\n        });\n    }\n}\n\nclass PlantBody {\n    genus: Genus;\n\n    bbox: BBox;\n    yFactor: number;\n\n    private parts: PlantPart[] | undefined;\n    private maxAge: number;\n\n    constructor( genus: Genus ) {\n        this.genus = genus;\n        this.bbox = new BBox;\n\n        this.maxAge = 0;\n        this.yFactor = 1;\n    }\n\n    private getTree() {\n        const getNodeAttr = ( pos: nodePos, prev: node | null, attr: nodeAttr ): nodeAttr => {\n            return {\n                width: this.genus.getNodeWidth( pos, prev, attr ),\n                angle: prev ? this.genus.getSegmentAngle( pos, prev, attr ) : 0,\n                length: pos.isLast ? (prev ? prev.attr.length : 0) : this.genus.getSegmentLength( pos, prev, attr ),\n                totalLength: prev ? ((pos.isOffshoot ? 0 : prev.attr.length) + prev.attr.totalLength) : 0,\n            };\n        };\n        const getOffshoots = (node: node | null): offshoot[] => {\n            if (node === null) return this.genus.getRoots();\n            return this.genus.getOffshoots( node );\n        };\n\n        return new ProcTree( this.genus.maxBranchNum, getNodeAttr, getOffshoots );\n    }\n\n    init(): void {\n        this.genus.reset();\n\n        const tree = this.getTree();\n        tree.grow();\n\n        this.bbox = new BBox({\n            x0: -this.genus.width/2,\n            x1: this.genus.width/2,\n            y0: -this.genus.height,\n            y1: 0,\n        });\n\n        const branches = new Branches;\n        const points = new Map;\n        let maxAge = 0;\n\n        const getBasePoint = (node: node): point => {\n            if (!node.prev) {\n                const p: point = [ node.attr.x || 0, 0 ];\n                this.bbox.addPoint( p[0], p[1] );\n                return p;\n            }\n            else if (node.pos.isOffshoot) {\n                const p = points.get( node.prev );\n                if (p) return p;\n\n                const rp: point = [ node.prev.attr.x || 0, 0 ];\n                points.set( node.prev, rp );\n                this.bbox.addPoint( rp[0], rp[1] );\n                return rp;\n            }\n\n            return points.get( node );\n        }\n\n        tree.eachSegment( (n0: node, n1: node): void => {\n\n            const base = getBasePoint( n0 );\n            const style = this.genus.getSegmentStyle( n0, n1 );\n            const s = new BranchSegment( base, style, n0, n1 );\n\n            points.set( n1, s.top );\n            this.bbox.addBBox( s.bbox );\n            branches.addSegment( n0.pos.branchNum, s );\n\n            this.genus.getLeaves( n0, n1 ).map( (cfg: leafDefinition): void => {\n                const leaf = new Leaf( s, cfg );\n\n                this.bbox.addBBox( leaf.bbox );\n                branches.addLeaf( n0.pos.branchNum, leaf );\n\n                if (leaf.ageOffset + leaf.length > maxAge) maxAge = leaf.ageOffset + leaf.length;\n            });\n\n            if (n1.attr.totalLength > maxAge) maxAge = n1.attr.totalLength;\n\n        });\n\n        this.parts = branches.getArray();\n        this.maxAge = maxAge;\n\n        // make sure the plant is centered\n        const bboxX = Math.max( Math.abs( this.bbox.x0 ), Math.abs( this.bbox.x1 ) );\n        this.bbox.x0 = -bboxX;\n        this.bbox.x1 = bboxX;\n\n        this.yFactor = (this.bbox.height / -this.bbox.y0) || 1;\n    }\n\n    private render( age: number, colors=true, svg: SVGElement ): void {\n        age *= this.maxAge;\n\n        if (this.parts) for (const p of this.parts) {\n            const points = p.getPoints( age );\n            if (!points) continue;\n\n            let style = {} as attributeSet, add = {} as attributeSet;\n\n            if (colors) {\n                style = p.style;\n                add = {};\n                if (typeof style['stroke-width'] == 'number') add['stroke-width'] = prc( style['stroke-width'] );\n            }\n\n            const set = Object.assign( {}, style, add, {\n                d: html.svg.compilePathDescription( points ),\n            });\n            svg.appendChild( html.svg.node( 'path', set ) );\n        }\n    }\n\n    getSvg( age: number, colors: boolean ): SVGElement {\n        if (this.parts === undefined) this.init();\n\n        const svg = html.svg.root({\n            class: 'svg-plant-body',\n            viewBox: this.bbox.withPrecision( precision ).viewBox,\n            preserveAspectRatio: 'xMidYMax meet',\n        });\n\n        this.render( age, colors, svg );\n\n        return svg;\n    }\n}\n\nexport { PlantBody };","import { plantPotSvg } from \"./plantPotSvg\";\nimport { PlantBody } from \"./PlantBody\";\nimport { html } from \"../util/util\";\nimport { attributeSet, Genus } from '../types';\n\ninterface SvgPlantCfg {\n    color: boolean,\n    age: number,\n    potSize: number,\n    potPathAttr: attributeSet,\n};\ninterface SvgPlantCfgArg {\n    color?: boolean,\n    age?: number,\n    potSize?: number,\n    potPathAttr?: attributeSet,\n};\n\ninterface PlantAnimation {\n    fromAge: number,\n    toAge: number,\n    ageSpan: number,\n    currentAge: number,\n\n    durationMs: number,\n\n    nextAnimationFrame: undefined | number,\n\n    paused: boolean,\n};\n\nclass SvgPlant {\n    body: PlantBody;\n    private cfg: SvgPlantCfg;\n\n    private _svgElement: SVGElement | null;\n    private _potSvgElement: SVGElement | null;\n    private _bodySvgElement: SVGElement | null;\n\n    private animation: PlantAnimation | null;\n\n    constructor( genus: Genus, cfg?: SvgPlantCfgArg ) {\n        this.cfg = {\n            color: true,\n            age: 1,\n            potSize: .3,\n            potPathAttr: { fill: '#fc7', stroke: '#da5' },\n        };\n\n        if (typeof cfg == 'object') {\n            if (cfg.color !== undefined) this.color = cfg.color;\n            if (cfg.age !== undefined) this.age = cfg.age;\n            if (cfg.potSize !== undefined) this.potSize = cfg.potSize;\n            if (cfg.potPathAttr !== undefined) this.potPathAttr = cfg.potPathAttr;\n        }\n\n        this.body = new PlantBody( genus );\n\n        this._svgElement = null;\n        this._potSvgElement = null;\n        this._bodySvgElement = null;\n\n        this.animation = null;\n    }\n\n    get seed(): string {\n        return this.body.genus.rngSeed;\n    }\n\n    get color(): boolean { return this.cfg.color; }\n    set color( v: boolean ) {\n        v = !!v;\n        if (v != this.cfg.color) {\n            this.cfg.color = v;\n            this.update();\n        }\n    }\n\n    get age(): number { return this.cfg.age; }\n    set age( v: number ) {\n        v = Math.max( 0, Math.min( v, 1 ));\n        if (v != this.cfg.age) {\n            this.cfg.age = v;\n            this.update( true, false );\n        }\n    }\n\n    get potSize(): number { return this.cfg.potSize; }\n    set potSize( v: number ) {\n        v = Math.max( 0, Math.min( v, 1 ));\n        if (v != this.cfg.potSize) {\n            this.cfg.potSize = v;\n            this.update( false, true );\n        }\n    }\n\n    get potPathAttr(): attributeSet { return this.cfg.potPathAttr; }\n    set potPathAttr( v: attributeSet ) {\n        if (v !== this.cfg.potPathAttr) {\n            this.cfg.potPathAttr = v;\n            this.update( false, true );\n        }\n    }\n\n    update( body=true, pot=true ) {\n        if (body) this._bodySvgElement = null;\n        if (pot) this._potSvgElement = null;\n        this.updateSvgElement();\n    }\n\n    get svgElement(): SVGElement {\n        if (!this._svgElement) {\n            this._svgElement = this.getSvgElement();\n        }\n        return this._svgElement;\n    }\n    updateSvgElement(): void {\n        const svg = this._svgElement;\n        if (!svg) return;\n\n        svg.innerHTML = this.getSvgElement().innerHTML;\n    }\n    getSvgElement(): SVGElement {\n        const svg = html.svg.root({\n            class: 'svg-plant',\n            viewBox: '0 0 1 1',\n            preserveAspectRatio: 'xMidYMax meet',\n        });\n\n        const place = ( el: Element, x: number, y: number, w: number, h: number ) => {\n            el.setAttribute( 'x', String( x ) );\n            el.setAttribute( 'y', String( y ) );\n            el.setAttribute( 'width', String( w ) );\n            el.setAttribute( 'height', String( h ) );\n        };\n\n        const pot = this.potSvgElement;\n        const body = this.bodySvgElement;\n\n        if (this.cfg.potSize >= 1 && pot !== null) {\n            svg.appendChild( pot );\n            place( pot, 0, 0, 1, 1 );\n        }\n        else if (this.cfg.potSize <= 0 && body !== null) {\n            svg.appendChild( body );\n            place( body, 0, 0, 1, 1 );\n        }\n        else if (pot && body) {\n            svg.appendChild( pot );\n            place( pot, 0, 1 - this.cfg.potSize, 1, this.cfg.potSize );\n            svg.appendChild( body );\n\n            // with high contrast there is a slight gap visible, between pot and plant.\n            // without color this is way more noticable, and the slight overlap is invisible.\n            const overlap = this.cfg.color ? 0 : .001;\n\n            let height;\n            const bodyHeight = 1 - this.cfg.potSize;\n\n            if (this.body.yFactor > 1) {\n                // this means the plant has points \"below the fold\"\n                // or: points that overlap the potsize area\n                // so the height of \"1 - this._cfg.potSize\" needs to be expanded accordingly\n\n                const wrapperAR = 1 / bodyHeight;\n                const aboveFoldBodyAR = this.body.bbox.width / -this.body.bbox.y0;\n                if (wrapperAR < aboveFoldBodyAR) {\n                    // the plantbody is scaled down, to fit the viewbox's width\n                    // the yFactor now needs to be applied only to the plants scaled down height\n                    // not the full available area of \"1 - this._cfg.potSize\"\n\n                    const scaledBodyHeight = -this.body.bbox.y0 / this.body.bbox.width;\n                    height = bodyHeight + (scaledBodyHeight * this.body.yFactor - scaledBodyHeight);\n                }\n                else {\n                    height = bodyHeight * this.body.yFactor;\n                }\n            }\n            else {\n                height = bodyHeight;\n            }\n\n            place( body, 0, 0, 1, height + overlap );\n\n        }\n\n        return svg;\n    }\n\n    get potSvgElement(): SVGElement | null {\n        if (this.cfg.potSize == 0) return null;\n\n        if (!this._potSvgElement) {\n            this._potSvgElement = this.getPotSvgElement();\n        }\n        return this._potSvgElement;\n    }\n    getPotSvgElement(): SVGElement {\n        if (!this.cfg.color) return plantPotSvg({});\n        return plantPotSvg( this.cfg.potPathAttr );\n    }\n\n    get bodySvgElement(): SVGElement | null {\n        if (this.cfg.potSize == 1) return null;\n\n        if (!this._bodySvgElement) {\n            this._bodySvgElement = this.getBodySvgElement();\n        }\n        return this._bodySvgElement;\n    }\n    getBodySvgElement(): SVGElement {\n        return this.body.getSvg( this.cfg.age, this.cfg.color );\n    }\n\n    animate( fromAge=0, toAge=1, durationMs=3000 ) {\n        this.cancelAnimation();\n\n        this.animation = {\n            fromAge,\n            toAge,\n            ageSpan: toAge - fromAge,\n            currentAge: fromAge,\n\n            durationMs,\n\n            nextAnimationFrame: undefined,\n\n            paused: true,\n        };\n\n        this.resumeAnimation();\n    }\n    pauseAnimation() {\n        if (this.animation) {\n            if (this.animation.nextAnimationFrame !== undefined) {\n                cancelAnimationFrame( this.animation.nextAnimationFrame );\n            }\n            this.animation.paused = true;\n        }\n    }\n    cancelAnimation() {\n        this.pauseAnimation();\n        this.animation = null;\n    }\n    resumeAnimation() {\n        const a = this.animation;\n        if (!a || !a.paused) return;\n        a.paused = false;\n\n        this.age = a.currentAge;\n\n        const acl = (t: number): number => t<0 ? 0 : t>1 ? 1 : Math.sin( (t - .5) * Math.PI ) * .5 + .5;\n        const aclInv = (t: number): number => t<0 ? 0 : t>1 ? 1 : Math.asin( t * 2 - 1 ) / Math.PI + .5;\n\n        let t0: number;\n        const upd = (ts: number) => {\n            if (!t0) {\n                const f = (a.currentAge - a.fromAge) / a.ageSpan;\n                t0 = ts - aclInv( f ) * a.durationMs;\n                a.nextAnimationFrame = requestAnimationFrame( upd );\n            }\n            else {\n                const f = acl( Math.min( 1, (ts - t0) / a.durationMs ) );\n\n                if (f < 1) {\n                    this.cfg.age = a.fromAge + f * a.ageSpan;\n                    a.currentAge = this.cfg.age;\n\n                    this._bodySvgElement = null;\n                    this.updateSvgElement();\n\n                    a.nextAnimationFrame = requestAnimationFrame( upd );\n                }\n                else {\n                    this.age = a.toAge;\n                    this.animation = null;\n                }\n            }\n        };\n\n        a.nextAnimationFrame = requestAnimationFrame( upd );\n    }\n}\n\nexport { SvgPlant };","import { rng, nodePos, nodeAttr, offshoot, node } from \"../util/util\";\nimport { rngSeed, attributeSet, leafCurvesHandles, leafDefinition, Genus } from '../types';\n\nclass BaseGenus implements Genus {\n\n    rng: rng;\n    width: number;\n    height: number;\n    maxBranchNum: number;\n\n    segmentStyle: attributeSet;\n    leafStyle: attributeSet;\n    leafCurveHandles: leafCurvesHandles;\n\n    constructor( rngSeed?: rngSeed ) {\n        this.rng = rng( rngSeed );\n\n        this.width = 4;\n        this.height = 4;\n        this.maxBranchNum = 1;\n\n        this.segmentStyle = {\n            fill: '#161',\n            stroke: '#041',\n            'stroke-width': .0075,\n        };\n\n        this.leafStyle = {\n            stroke: '#0d5',\n            fill: 'rgba(0,255,110,.9)',\n            'stroke-width': .02,\n        };\n        this.leafCurveHandles = {\n            bottomAngle: 60,\n            bottomLength: .6,\n            topAngle: 179,\n            topLength: .2,\n        };\n    }\n\n    static get genusName(): string {\n        const cn = this.name;\n        return cn.substring( 0, cn.length - 5 );\n    }\n    get genusName(): string {\n        const cn = this.constructor.name;\n        return cn.substring( 0, cn.length - 5 );\n    }\n    get rngSeed(): string {\n        return this.rng.seed;\n    }\n    reset(): void {\n        this.rng.reset();\n    }\n\n    getRoots(): offshoot[] {\n        return [\n            {\n                n: 3,\n                attr: { x: 0, segmentAngle: 0 }\n            },\n        ];\n    }\n    getOffshoots( node: node ): offshoot[] {\n        if (node.pos.isLast || node.pos.num==0) return [];\n\n        return [\n            {\n                n: 1,\n                attr: { segmentAngle: node.attr.angle - 60 }\n            },\n            {\n                n: 1,\n                attr: { segmentAngle: node.attr.angle + 60 }\n            },\n        ];\n    }\n\n    getNodeWidth( _pos: nodePos, _prev: node | null, _attr: nodeAttr ): number {\n        return .1;\n    }\n    getSegmentLength( _pos: nodePos, _prev: node | null, _attr: nodeAttr ) {\n        return 1;\n    }\n    getSegmentAngle( pos: nodePos, prev: node, _attr: nodeAttr ) {\n        if (pos.isOffshoot) return prev.attr.angle;\n        return prev.attr.segmentAngle !== undefined ? prev.attr.segmentAngle : prev.attr.angle;\n    }\n\n    getSegmentStyle( _n0: node, _n1: node ): attributeSet {\n        return this.segmentStyle;\n    }\n\n    getLeaves( _n0: node, n1: node ): leafDefinition[] {\n        if (!n1.pos.isLast) return [];\n\n        return [\n            {\n                angle: n1.attr.angle,\n                length: 1,\n                handles: this.leafCurveHandles,\n                style: this.leafStyle,\n\n                xOffset: 0,\n                yOffset: .95,\n            }\n        ];\n    }\n};\n\nexport { BaseGenus };","import { BaseGenus } from \"./BaseGenus\";\nimport { plantHelper, node, nodePos, nodeAttr } from \"../util/util\";\nimport { Genus, rngSeed } from '../types';\n\nclass CannabisGenus extends BaseGenus implements Genus {\n\n    constructor( rngSeed?: rngSeed, colorize: any) {\n        super( rngSeed );\n\n        this.width = 3.6;\n        this.height = 3.5;\n        this.maxBranchNum = 900;\n\n        this.segmentStyle = {\n            stroke: '#041',\n            fill: '#161',\n            'stroke-width': .0075,\n        };\n\n        this.leafStyle = {\n            stroke: colorize(rngSeed),\n            fill: 'rgba(0,255,110,.9)',\n            'stroke-width': .03\n        };\n        this.leafCurveHandles = {\n            bottomAngle: 50,\n            bottomLength: .3,\n            topAngle: 179,\n            topLength: .1\n        };\n    }\n\n    getRoots() {\n        return [\n            {\n                n: this.rng.intRange( 4, 6 ),\n                attr: plantHelper.rootPosAngle( this.rng, .5, 6 ),\n            },\n        ];\n    }\n    getOffshoots( node: node ) {\n        if (node.pos.isLast || node.pos.num==0) return [];\n\n        const p = .9 * (.9 + .5 * node.pos.numFactor) * (.9 + .5 * node.pos.branchFactor);\n        const a = [];\n\n        const getNodeCount = () => 4 - node.pos.branchNum - this.rng.test( .6, 1, 0 );\n\n        if (this.rng.test( p )) a.push({\n            n: getNodeCount(),\n            attr: {\n                segmentAngle: node.attr.angle + this.rng.range( 25, 60 ),\n            }\n        });\n\n        if (this.rng.test( p )) a.push({\n            n: getNodeCount(),\n            attr: {\n                segmentAngle: node.attr.angle + this.rng.range( -60, -25 ),\n            }\n        });\n\n        return a;\n    }\n\n    getNodeWidth( pos: nodePos, prev: node | null, _attr: nodeAttr ) {\n        if (pos.isOffshoot && prev) return prev.attr.width;\n        return .1 * (.1 + .4 * pos.branchFactor);\n    }\n    getSegmentLength( pos: nodePos, prev: node | null, _attr: nodeAttr ) {\n        if (!prev) return 1;\n        if (!pos.isOffshoot && pos.branchNum>0) return prev.attr.length * .75;\n        if (!pos.isOffshoot) return prev.attr.length;\n\n        const f = .2 + .8 * (prev.branchRoot.prev ? prev.branchRoot.prev.pos.numFactor : 1);\n        return prev.attr.length * f;\n    }\n    getSegmentAngle( pos: nodePos, prev: node, _attr: nodeAttr ) {\n        if (pos.branchNum>0) return plantHelper.nextAngle( this.rng, pos, prev, 16, true );\n        return plantHelper.nextAngle( this.rng, pos, prev, 8, true );\n    }\n\n    getSegmentStyle( _n0: node, _n1: node ) {\n        return this.segmentStyle;\n    }\n\n    getLeaves( _n0: node, n1: node ) {\n        if (n1.pos.branchNum==0 && n1.pos.num<2) return [];\n\n        const leaves: leafDefinition[] = [];\n\n        const addLeaf = (avf: number) => {\n            leaves.push({\n                angle: n1.attr.angle + (avf ? (avf * this.rng.range( 20, 40 )) : this.rng.range( -10, 10 )),\n                length: this.rng.range( .5, .75 ),\n                handles: this.leafCurveHandles,\n                style: this.leafStyle,\n\n                xOffset: avf ? -avf * this.rng.range( 0, .5) : 0,\n                yOffset: avf ? this.rng.range( .3, .7 ) : .95,\n            });\n        };\n\n        if (n1.pos.isLast && this.rng.test( .5 )) addLeaf( 0 );\n        if (n1.pos.isLast && this.rng.test( .5 )) addLeaf( 0 );\n        if (this.rng.test( .5 )) addLeaf( 1 );\n        if (this.rng.test( .5 )) addLeaf( -1 );\n        if (this.rng.test( .5 )) addLeaf( 2 );\n        if (this.rng.test( .5 )) addLeaf( -2 );\n        if (this.rng.test( .5 )) addLeaf( 3 );\n        if (this.rng.test( .5 )) addLeaf( -3 );\n\n        return leaves;\n    }\n};\n\nexport { CannabisGenus };","import { SvgPlant } from \"../Plant/SvgPlant\";\nimport { PlantBody } from \"../Plant/PlantBody\";\nimport { GenusConstructor } from '../types';\n\nconst testPlantBodySize = (genus: GenusConstructor, n=1000) => {\n    const widths: number[] = [];\n    const heights: number[] = [];\n\n    for (let i=0; i<n; i++) {\n        const p = (new SvgPlant( new genus )).body;\n        p.genus.width = 0;\n        p.genus.height = 0;\n        p.init();\n\n        widths.push( p.bbox.width );\n        heights.push( p.bbox.height );\n    }\n\n    widths.sort( (a,b) => a - b );\n    heights.sort( (a,b) => a - b );\n\n    return ( q=50 ) => {\n        const i = Math.max( 0, Math.min( n-1, Math.round( q / 100 * (n-1) ) ) );\n        return {\n            width: widths[ i ],\n            height: heights[ i ],\n        };\n    };\n};\n\nconst findSeed = (genus: GenusConstructor, test: (p: PlantBody) => boolean, timeoutMs=10*1000) => {\n    let cancel = false, n = 0, seed;\n    const t0 = Date.now();\n\n    const to = setTimeout(() => {\n        cancel = true;\n    }, timeoutMs );\n\n    while (true) {\n        const p = (new SvgPlant( new genus )).body;\n        p.genus.width = 0;\n        p.genus.height = 0;\n        p.init();\n        n++;\n\n        if (test( p )) {\n            clearTimeout( to );\n            seed = p.genus.rngSeed;\n            console.log( 'Seed found!', seed );\n            break;\n        }\n\n        if (cancel) {\n            console.log( 'No seed was found' );\n            break;\n        }\n    }\n\n    const t = ((Date.now() - t0) / 1000 ).toFixed( 2 );\n    console.log( 'findSeed finished after ' + t + ' seconds and ' + n + ' tries.' );\n\n    return seed;\n};\n\nconst testPerformance = (genus: GenusConstructor, durationMs=10*1000) => {\n    const t0 = Date.now();\n    let n = 0;\n\n    while (true) {\n        const p = (new SvgPlant( new genus )).body;\n        p.genus.width = 0;\n        p.genus.height = 0;\n        p.init();\n        n++;\n\n        if (Date.now() - t0 > durationMs) break;\n    }\n\n    const ms = Date.now() - t0;\n    const s = ms / 1000;\n\n    console.group( genus.name + ' Performance Test' );\n    console.log( 'created ' + n + ' plants in ' + s.toFixed( 2 ) + ' seconds' );\n    console.log( (n/s).toFixed(2) + ' plants/sec' );\n    console.log( (ms/n).toFixed(2) + ' ms/plant' );\n    console.groupEnd();\n\n    return;\n}\n\nexport {\n    testPlantBodySize,\n    findSeed,\n    testPerformance,\n}","\nimport { SvgPlant } from './Plant/SvgPlant';\nimport { BaseGenus } from './Genera/BaseGenus';\nimport { CannabisGenus } from './Genera/CannabisGenus';\nimport * as DevTools from './util/DevTools';\nimport { plantHelper } from './util/util';\n\nconst Genera = {\n    'Cannabis' : CannabisGenus,\n};\n\nexport {\n    SvgPlant,\n    Genera,\n    BaseGenus, CannabisGenus, \n    plantHelper,\n    DevTools,\n};"],"names":["html","node","tag","set","document","createElement","attr","nodeNS","ns","createElementNS","name","setAttribute","String","svg","root","setAttributeNS","el","compilePathDescription","points","d","p","length","push","join","math","toRadians","degrees","Math","PI","fromAngle","point","angle","precision","a","sin","cos","round","rectFromLine","pointBottom","pointTop","angleBottom","angleTop","widthBottom","widthTop","pointOnLine","p1","p2","distance","dx","dy","sqrt","plantHelper","rootPosAngle","rng","xMax","maxAngle","x","range","f","abs","segmentAngle","baseNode","undefined","nextAngle","pos","prevNode","variance","alternate","isOffshoot","pa","dir","branchNum","treeRoot","num","archingBranchAngle","numAdjust","base","branchRoot","branchArchAngle","numFactor","repeat","cb","shuffle","steps","values","n","test","v","i","from","to","step","Array","isArray","intRange","seed","seedStr","random","substring","fn","reset","seedrandom","pass","fail","r","v0","v1","floor","ranges","ep","last","pop","j","tmp","BBox","constructor","data","x0","x1","y0","y1","Infinity","addX","addY","addPoint","y","addBBox","bbox","expand","contains","strict","containedBy","containsPoint","clone","withPrecision","width","height","aspectRatio","pointsArray","viewBox","ProcTree","maxBranchNum","getNode","getOffshoots","roots","grow","growBranch","Number","rootNode","offshootNum","segmentCount","isTreeRoot","addNode","isLastBranch","offshoots","prev","maxNum","rootAttr","getPos","next","offshootHeight","isRoot","isLast","branchFactor","eachSegment","_each","offshootNode","plantPotSvg","pathAttr","baseCfg","rimHeight","rimLipOuter","rimLipInner","bottom","sw","pad","getPoints","cfg","path","class","preserveAspectRatio","appendChild","expandXBounds","bounds","value","minX","maxX","expandYBounds","minY","maxY","calculateBezier","t","p0","p3","mt","bezierCurveBoundingBox","cx1","cy1","cx2","cy2","x2","y2","min","max","dcx0","dcy0","dcx1","dcy1","dcx2","dcy2","b","c","numerator","denominator","quadroot","t1","t2","prc","BranchSegment","style","n0","n1","bottomWidth","topWidth","bottomAngle","topAngle","top","ageOffset","totalLength","getBoundingBox","age","ageFactor","getAgeFactor","bb","getOffsetPoint","l1","l2","l3","Leaf","segment","handles","xOffset","yOffset","pBase","curves","getCurves","up","down","bha","bhl","bottomLength","tha","thl","topLength","Branches","segments","leaves","addSegment","branch","addLeaf","leaf","getArray","ret","concat","sortLeaves","sort","l0","d0","d1","PlantBody","genus","maxAge","yFactor","getTree","getNodeAttr","getNodeWidth","getSegmentAngle","getSegmentLength","getRoots","init","tree","branches","Map","getBasePoint","get","rp","getSegmentStyle","s","getLeaves","map","parts","bboxX","render","colors","add","Object","assign","getSvg","SvgPlant","color","potSize","potPathAttr","fill","stroke","body","_svgElement","_potSvgElement","_bodySvgElement","animation","rngSeed","update","pot","updateSvgElement","svgElement","getSvgElement","innerHTML","place","w","h","potSvgElement","bodySvgElement","overlap","bodyHeight","wrapperAR","aboveFoldBodyAR","scaledBodyHeight","getPotSvgElement","getBodySvgElement","animate","fromAge","toAge","durationMs","cancelAnimation","ageSpan","currentAge","nextAnimationFrame","paused","resumeAnimation","pauseAnimation","cancelAnimationFrame","acl","aclInv","asin","t0","upd","ts","requestAnimationFrame","BaseGenus","segmentStyle","leafStyle","leafCurveHandles","genusName","cn","_pos","_prev","_attr","_n0","_n1","CannabisGenus","colorize","getNodeCount","avf","testPlantBodySize","widths","heights","q","findSeed","timeoutMs","cancel","Date","now","setTimeout","clearTimeout","console","log","toFixed","testPerformance","ms","group","groupEnd","Genera"],"mappings":"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"}